{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport * as buble from 'buble';\n\nvar transformCode = function transformCode(code) {\n  var opts = {\n    transforms: {\n      dangerousForOf: true,\n      dangerousTaggedTemplateString: true\n    }\n  };\n  console.log('before', code);\n  var newCode = buble.transform(code, opts).code;\n  console.log('after', newCode);\n  return newCode;\n};\n\nexport default\n/*#__PURE__*/\n(function () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee2(_ref) {\n    var __deps__, __imports__, Box, _imports__$utils, React, _, icons, CodeEditor, napi, NodeView, iconSize, viewer, createViewFromSrc, defaultSrc, Node, view, edit, icon, preview;\n\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            __deps__ = _ref.__deps__, __imports__ = _ref.__imports__;\n            Box = __imports__.grommet.Box;\n            _imports__$utils = __imports__.utils, React = _imports__$utils.React, _ = _imports__$utils.lodash, icons = _imports__$utils.icons, CodeEditor = _imports__$utils.CodeEditor;\n            napi = __deps__.napi, NodeView = __deps__.NodeView, iconSize = __deps__.iconSize, viewer = __deps__.viewer; // eslint-disable-next-line no-new-func\n\n            createViewFromSrc = function createViewFromSrc(fbody) {\n              var deps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n              return function (props) {\n                return Function('__props__', '__imports__', '__deps__', fbody)(props, __imports__, deps);\n              };\n            }; // const defaultSrc = `\n            //   const { React } = __imports__.utils\n            //   const { Box } = __imports__.grommet\n            //   const { node } = __deps__\n            //   const e = React.createElement\n            //\n            //   return e(Box, { align: 'center', justify: 'center', fill: true }, node.name)\n            // `\n\n\n            defaultSrc = \"\\n    const { React } = __imports__.utils\\n    const { Box } = __imports__.grommet\\n    const { node } = __deps__\\n\\n    return (\\n      <Box fill align='center' justify='center'>\\n        {node.name}\\n      </Box>\\n    )\\n  \";\n\n            Node = function Node(props) {\n              return React.createElement(NodeView, _objectSpread({}, props, {\n                napi: napi,\n                plain: true\n              }));\n            };\n\n            view = function view(_ref3) {\n              var node = _ref3.node;\n              return React.createElement(createViewFromSrc(transformCode(_.get(node.sides, 'web.src', defaultSrc)), {\n                napi: napi,\n                NodeView: NodeView,\n                node: node,\n                Node: Node\n              }));\n            };\n\n            edit = function edit(_ref4) {\n              var node = _ref4.node;\n              var size = 'medium';\n\n              var value = _.get(node, 'sides.web.src', defaultSrc);\n\n              var background = _.get(node, 'sides.web.background', {\n                color: 'black',\n                opacity: 'strong'\n              });\n\n              return React.createElement(Box, {\n                fill: true,\n                align: \"center\",\n                justify: \"center\",\n                pad: \"small\"\n              }, React.createElement(Box, {\n                fill: true,\n                align: \"center\",\n                justify: \"center\",\n                round: \"small\",\n                background: background,\n                direction: \"row\"\n              }, React.createElement(Box, {\n                fill: true,\n                overflow: \"scroll\"\n              }, React.createElement(NodeView, {\n                node: node,\n                view: \"web\",\n                napi: napi,\n                viewer: viewer\n              })), React.createElement(Box, {\n                fill: true,\n                align: \"start\",\n                justify: \"start\",\n                pad: \"small\",\n                overflow: \"scroll\"\n              }, React.createElement(CodeEditor, {\n                value: value,\n                onChange: function onChange(newValue) {\n                  return napi.updateNodeSide(node, 'web/src', newValue);\n                },\n                options: {\n                  size: size,\n                  language: 'javascript'\n                }\n              }))));\n            };\n\n            icon = function icon(_ref5) {\n              var node = _ref5.node;\n              return React.createElement(Box, {\n                fill: true,\n                align: \"center\",\n                justify: \"center\"\n              }, React.createElement(icons.Code, {\n                size: iconSize\n              }));\n            };\n\n            preview = icon;\n            return _context2.abrupt(\"return\", {\n              create: function () {\n                var _create = _asyncToGenerator(\n                /*#__PURE__*/\n                regeneratorRuntime.mark(function _callee(_ref6) {\n                  var node;\n                  return regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          node = _ref6.node;\n                          return _context.abrupt(\"return\", {\n                            side: {\n                              code: defaultSrc\n                            }\n                          });\n\n                        case 2:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                }));\n\n                function create(_x2) {\n                  return _create.apply(this, arguments);\n                }\n\n                return create;\n              }(),\n              modes: {\n                icon: icon,\n                preview: preview,\n                view: view,\n                edit: edit\n              }\n            });\n\n          case 12:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n})();"],"names":["buble.transform"],"mappings":"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"}